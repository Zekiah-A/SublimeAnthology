<!DOCTYPE html>
<html>

<head>
    <title>Subliminal</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="description" content="The contents page of the weirdest poetry anthology to ever exist. Manage your account, and search for poems here.">
    <meta name="keywords" content="Poetry, Contents, Anthology, Subliminal, Search">
    <link rel="stylesheet" href="styles.css">
    <script src="header.js"></script>
    <script src="account.js"></script>
    <style>
        .section-span {
            cursor: pointer;
            max-width: 20%;
            width: 20%;
            transition: .2s all;
            transition: font-weight .2s;
        }

        .section-body {
            /*border-radius: 10px;
            border-left: 2px solid grey;
            padding-left: 5px;*/
            transition: transform .5s, opacity .5s;
        }

        .section-collapsed {
            position: absolute;
            top: 32px;
            transform: translate(-50%);
            right: 16px;
            transform-origin: center;
            transition: .2s transform;
        }

        .section-collapsed > svg {
            fill: var(--text-colour);
        }

        .grid-container {
            display: grid;
            grid-template-columns: auto auto;
            padding: 10px;
            grid-gap: 10px;
        }

        .grid-sub-container {
            display: flex;
            flex-direction: row;
            border-radius: 8px;
            margin: 8px;
            padding: 8px;
            background-color: var(--panel-transparent);
            position: relative;
            transition: max-height .2s;
            overflow: hidden;
        }

        .grid-sub-container[collapsed] {
            max-height: 64px;
        }

        .grid-sub-container[collapsed] > .section-span {
            max-width: 100%;
            width: 100%;
            font-weight: bold;
        }

        .grid-sub-container[collapsed] > .section-body {
            transform: translateX(110%);
            opacity: 0;
        }

        .grid-sub-container[collapsed] > .section-collapsed {
            transform: translate(-50%) rotate(-90deg);
        }

        .poem-preview {
            display: none;
            position: fixed;
            left: 20px;
            top: 200px;
            width: 250px;
            height: 400px;
            border: 2px solid grey;
            border-radius: 2px;
            background: white;
        }

        .poem-preview > iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /*Purgatory flex CSS*/
        #purgatoryFlex {
            display: flex;
            max-width: 100%;
            padding: 8px;
            flex-direction: row;
            column-gap: 16px;
            overflow-x: scroll;
            user-select: none;
            overflow-y: hidden;
        }

        #purgatoryGrid {
            display: grid;
            grid-template-columns: auto auto auto auto auto;
            grid-gap: 16px;
            max-height: 600px;
            overflow: hidden;
            overflow-y: scroll;
            position: relative;
        }

        /*#purgatoryGrid::after {
            opacity: 1;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            position: absolute;
            background: linear-gradient(white 4px, transparent 64px, transparent calc(100% - 64px), white calc(100% - 4px));
            content: "";
            transition: opacity 1s;
        }*/

        entry {
            min-width: 200px;
            height: 200px;
            border-radius: 4px;
            background-color: var(--button-opaque);
            position: relative;
            cursor: pointer;
            max-width: 200px;
            transition: scale 1s, rotate 1s, background-color 1s, transform 1s, z-index 1s, box-shadow 1s;
        }

        entry h4 {
            text-align: center;
            font-size: 20px;
            max-width: 100%;
            margin-left: 8px;
            margin-right: 8px;
            overflow: hidden;
            white-space: nowrap;
        }

        entry .preview {
            margin: 16px;
            position: relative;
            border-radius: 8px;
            overflow: clip;
            font-size: 16px;
            height: 64px;
        }

        entry .special-notification {
            margin-top: 0px;
            margin-bottom: 0px;
            color: #017cff;
            position: absolute;
            top: 44%;
            text-align: center;
            width: 100%;
            font-weight: bold;
            font-style: italic;
        }

        entry .button-tooltip {
            left: 0px !important;
            top: 0px !important;
        }

        entry .preview::after {
            opacity: 1;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            position: absolute;
            background: linear-gradient(var(--button-opaque), transparent, var(--button-opaque));
            content: "";
            transition: opacity 1s;
        }

        entry .info {
            display: flex;
            flex-direction: row;
            margin-left: 8px;
            margin-right: 8px;
        }

        entry svg {
            fill: var(--text-colour);
        }

        .entry-new {
            rotate: 10deg;
            scale: 1.1;
            background-color: #fdfdfd;
            transform: translateX(32px);
            z-index: 1;
            box-shadow: 0px 0px 20px black;
        }

        .entry-new .preview::after {
            opacity: 0 !important;
        }

        #filtersBar {
            display: flex;
            justify-content: center;
            column-gap: 4px;
            margin: 8px;
        }

        #filtersBar > div {
            border-radius: 32px;
            padding: 1px;
            position: relative;
        }

        #filtersBar > div > div {
            padding-left: 12px;
            padding-right: 12px;
            padding-top: 4px;
            padding-bottom: 4px;
            background-color: var(--button-transparent);
            border-radius: 32px;
            user-select: none;
            pointer-events: none;
        }

        .signup-code-hidden {
            background: gray;
            border-radius: 4px;
            color: gray;
            cursor: pointer;
            transition: .2s all;
        }

        #login {
            width: 400px;
            height: auto;
        }

        #login[currentpage="signin"] > #loginSignin {
            display: block !important;
        }

        #login[currentpage="signup"] > #loginSignup {
            display: block !important;
        }

        #login[currentpage="code"] > #loginCode {
            display: block !important;
        }

        @media screen and (orientation:portrait) {
            .grid-container {
                grid-template-columns: auto;
            }

            .grid-sub-container {
                flex-direction: column;
            }

            .section-span {
                max-width: 100%;
                width: 100%;
            }

            #purgatoryGrid {
                grid-template-columns: auto auto;  
            }

            #loginButton, #accountButton {
                position: fixed;
                z-index: 2;
                right: 8px;
                top: 64px;
                height: 46px;
                border-radius: 0px 4px 4px 0px;
            }
        }

        @media(prefers-color-scheme: dark) {
            .entry-new {
                background-color: #606060;
            }
        }
    </style>
    <script type="text/javascript" src="./qrious-min.js"></script>
</head>

<body class="contents-div-centre" onkeydown="if ('value' in document.activeElement) return; searchbar.focus()">
    <br><br><br>
    <div style="display: flex;margin-top: 40px;column-gap: 8px;">
        <h1 style="margin-bottom: 0px;margin-top: 0px;">Contents</h1>
        <input type="text" class="searchbar" id="searchbar" onkeyup="searchContents(this.value)" placeholder="search poems">
        <input id="loginButton" type="button" value="Login to Subliminal" onclick="login.style.display = 'block';">
        <input id="accountButton" type="button" value="My subliminal account" style="display: none;"
            onclick="window.location.href = './account';">
    </div>
    <div id="login" style="display: none;" class="popup" currentpage="signin">
        <h2>Login to Subliminal:</h2>
        <div id="loginSignin" style="display: none;">
            <input id="loginSigninInput" type="text" class="popup-input" placeholder="Account code">
            <div style="display:flex;column-gap:8px;margin-top:8px">
                <div class="popup-button" onclick="login.setAttribute('currentpage', 'signup');">I don't have an account
                </div>
                <div class="popup-button" onclick="signin(loginSigninInput.value); login.style.display = 'none';">Login
                </div>
            </div>
        </div>
        <div id="loginSignup" style="display: none;">
            <input id="loginPenName" type="text" class="popup-input" placeholder="Pen name">
            <input id="coolPromise" type="checkbox">
            <label for="coolPromise">I promise to be a cool member of subliminal</label>
            <div style="display:flex;column-gap:8px;margin-top:8px">
                <div class="popup-button"
                    onclick="login.setAttribute('currentpage', 'code'); signup(loginPenName.value);">Create account
                </div>
            </div>
        </div>
        <div id="loginCode" style="display: none;">
            <p>Your account code is the key for acessing your account, keep it private!</p>
            <span>Code:&nbsp;</span><span id="loginCodeText" class="signup-code-hidden"
                onmouseenter="this.style.background = 'transparent'; this.style.color = 'black';">00000000</span>
            <p>or</p>
            <div style="position: relative; display: inline-block;">
                <img id="loginCodeQR" width="200" height="200" style="width:200px;height:200px; filter: blur(16px);"
                    onmouseenter="this.style.filter = 'blur(0px)';">
                <img width="64" height="64" src="./Resources/SmallLogo.png"
                    style="width:64px;height:64px;position:absolute;left:68px;top:68px;opacity:0.4;">
            </div>
            <br>
            <div class="popup-button"
                onclick="login.setAttribute('currentpage', 'signin'); login.style.display = 'none';">Close</div>
        </div>
    </div>
    <div class="poem-preview">
        <iframe src="/Volume-1/Really-Stupid-Stuff/bibbilance">

        </iframe>
    </div>
    <h3 style="margin-bottom: 0px;">Poem Purgatory:</h3>
    <div id="filtersBar">
        <div onclick="addPurgatoryEntries('new')">
            <div>New</div>
            <tooltip class="button-tooltip">The top poems with the most recent activity, be it new reviews or releases.</tooltip>
        </div>
        <div onclick="addPurgatoryEntries('liked')">
            <div>Liked</div>
            <tooltip class="button-tooltip">Your favourite poems, in the purgatory. Use the star icon in the corner of a poem to like or unlike it.</tooltip>
        </div>
        <div onclick="addPurgatoryEntries('all')">
            <div>All</div>
            <tooltip class="button-tooltip">Every poem in the purgatory! Be warned: The list may be quite long...</tooltip>
        </div>
    </div>
    <div id="purgatoryFlex">
    </div>
    <div id="purgatoryGrid" style="display: none;">
    </div>
    <div class="grid-container">
        <a href="poem-editor">+Add a Poem</a>
        <div></div>
        <div>
            <h3>Volume 1: (Phrenes and Memes)</h3>
            <div class="grid-sub-container">
                <p class="section-span" onclick="this.parentElement.toggleAttribute('collapsed')">War and Phrenics:</p>
                <span class="section-collapsed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" height="24" width="36"><path d="m24 30.75-12-12 2.15-2.15L24 26.5l9.85-9.85L36 18.8Z"></path></svg></span>
                <div class="section-body">
                    <a href="./poem?path=/Volume-1/War-And-Phrenics/besusk">1. Besusk - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-1/War-And-Phrenics/the-sitting-down-of-the-opacity-brigade">2. The sitting down of the opacity brigade - By Bushi</a>
                    <br>
                    <a href="./poem?path=/Volume-1/War-And-Phrenics/venger">3. Venger - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-1/War-And-Phrenics/stomped">4. Stomped - By Junaid</a>
                    <br>
                    <a href="./poem?path=/Volume-1/War-And-Phrenics/bamitz">5. Bamitz - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-1/War-And-Phrenics/seppaku">6. Seppaku - By Bushi</a>
                    <br>
                    <a href="./poem?path=/Volume-1/War-And-Phrenics/blood-oath">7. Blood Oath - By Bushi</a>
                    <br>
                    <a href="./poem?path=/Volume-1/War-And-Phrenics/viiiiibraaanium">8. Viiiiibraaanium! - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-1/War-And-Phrenics/happy-old-man">9. Happy Old Man - By Bushi</a>
                    <br>
                    <a href="./poem?path=/Volume-1/War-And-Phrenics/tenacity">10. Tenacity - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-1/War-And-Phrenics/who-art-in-heaven">11. Who art in heaven? - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-1/War-And-Phrenics/the-ride">12. The Ride - By Axel</a>
                    <br>
                    <a href="./poem?path=/Volume-1/War-And-Phrenics/blitzkrieg">13. BLITZKRIEG - By Zekiah</a>
                    <br>
                </div>
            </div>
            <div class="grid-sub-container">
                <p class="section-span" onclick="this.parentElement.toggleAttribute('collapsed')">Really Stupid Stuff:</p>
                <span class="section-collapsed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" height="24" width="36"><path d="m24 30.75-12-12 2.15-2.15L24 26.5l9.85-9.85L36 18.8Z"></path></svg></span>
                <div class="section-body">
                    <a href="./poem?path=/Volume-1/Really-Stupid-Stuff/bibbilance">1. Bibbilance - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Really-Stupid-Stuff/sylable-of-obamama">2. Sylable Of Obamama - By Bushi</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Really-Stupid-Stuff/hän-vaan-istu">3. Hän vaan istu - By Noah</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Really-Stupid-Stuff/organs">4. Organs - By Bushi</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Really-Stupid-Stuff/shifty-will">5. Shifty Will - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Really-Stupid-Stuff/i-don't-write-poems">6. I don't write POEMS - By Noah</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Really-Stupid-Stuff/i-saw-you-at-5:03-on-persely-road">7. I saw you at 5:03 on Persely Road - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Really-Stupid-Stuff/badges-ft-cardi-b">8. Badges (Ft Cardi B) - By Lucky</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Really-Stupid-Stuff/statude-des-amongus">9. Statude des Amongus - By Bushi</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Really-Stupid-Stuff/8:19:59">10. 8:19:59 - By Angelos</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Really-Stupid-Stuff/once-in-princess-selva's-classroom">11. Once in Princess Selva's classroom - By Angelos</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Really-Stupid-Stuff/effavescence">12. Effavescence - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Really-Stupid-Stuff/creativity">13. Creativity - By Bushi</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Really-Stupid-Stuff/this-is-(not)-the-art-of-war">14. This is (not) "the art of war" - By Bushi</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Really-Stupid-Stuff/trolling-my-pen">15. Trolling my Pen - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Really-Stupid-Stuff/squib-games">16. Squib Games - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Really-Stupid-Stuff/mr-fisher">17. Mr Fisher - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Really-Stupid-Stuff/skyfall">18. Skyfall - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Really-Stupid-Stuff/carbo-hydron-of-death">19. Carbo-Hydron of death - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Really-Stupid-Stuff/soyware">20. Soyware - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Really-Stupid-Stuff/jet-black">21. Jet Black - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Really-Stupid-Stuff/ten">22. TEN - By Zekiah</a>
                    <br>
                </div>
            </div>
            <div class="grid-sub-container">
                <p class="section-span" onclick="this.parentElement.toggleAttribute('collapsed')">Parodies and Adaptations:</p>
                <span class="section-collapsed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" height="24" width="36"><path d="m24 30.75-12-12 2.15-2.15L24 26.5l9.85-9.85L36 18.8Z"></path></svg></span>
                <div class="section-body">
                    <a href="./poem?path=/Volume-1/Parodies-And-Adaptations/the-interlude">1. The Interlude - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Parodies-And-Adaptations/stuff-on-the-iso">2. Stuff On The Iso - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Parodies-And-Adaptations/ink">3. Ink - By Bushi</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Parodies-And-Adaptations/tree-stumps">4. Tree Stumps - By Angelos</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Parodies-And-Adaptations/ozyandyas">5. Ozyandyas - By Angelos</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Parodies-And-Adaptations/public-toilet">6. Public Toilet - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Parodies-And-Adaptations/ketones">7. Ketones - By Angelos</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Parodies-And-Adaptations/my-first-among-us-game">8. My first Among Us game - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Parodies-And-Adaptations/composed-upon-mount-isso">9. Composed upon Mount Isso, March 22, 2022 - By Angelos</a>
                    <br>
                    <a href="./poem?path=/Volume-1/Parodies-And-Adaptations/the-charge-of-the-bike-brigade">10. The Charge Of The Bike Brigade - By Angelos</a><sup id="addition">new</sup>
                    <br>
                </div>
            </div>
        </div>
        <div>
            <h3>Volume 2: (Idiots and Revelations)</h3>
            <div class="grid-sub-container">
                <p class="section-span" onclick="this.parentElement.toggleAttribute('collapsed')">Idiots:</p>
                <span class="section-collapsed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" height="24" width="36"><path d="m24 30.75-12-12 2.15-2.15L24 26.5l9.85-9.85L36 18.8Z"></path></svg></span>
                <div class="section-body">
                    <a href="./poem?path=/Volume-2/Idiots/the-great-prison-of-america">1. The Great Prison Of America - By Bushi</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Idiots/industrial-society">2. Industrial Society - By Bushi</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Idiots/a-conclusive-thesis-on-modern-day-consumerism">3. A conclusive thesis on modern day consumerism - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Idiots/reality">4. Reality - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Idiots/a-long-road-to-al'mogus">5. A long road to Al'mogus - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Idiots/dear-liberals">6. Dear, liberals - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Idiots/old-man-consequences">7. Old Man Consequences - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Idiots/i-am-sorrounded-by-idiots">8. I am sorrounded by Idiots - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Idiots/an-unfortunate-event">9. An Unfortunate Event - By Bushi</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Idiots/modern-day-brockelhurst">10. Modern Day Brockelhurst - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Idiots/the-epilogue">11. The Epilogue - By Bushi</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Idiots/erfolgreich-wenn">12. Erfolgreich Wenn? - By Bushi</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Idiots/asylum">13. Asylum - By Bushi</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Idiots/a-doctor-of-schizophrenia">14. A doctor of Schizophrenia - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Idiots/five-a-side-footie">15. Five-a-side Footie - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Idiots/a-gay-encounter">16. A gay encounter - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Idiots/we-live-in-a-dictatorship">17. We live in a dictatorship - By Angelos</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Idiots/the-police-cause-all-the-chaos">18. The police cause all the chaos - By Angelos</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Idiots/suspended-in-h">19. Suspended in H - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Idiots/mifism">20. MIFISM - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Idiots/litigations">21. Litigations - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Idiots/almost-as-stone-as-a-rock">22. Almost as stone as a rock - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Idiots/cupcake-bomb">23. Cupcake Bomb - By Zekiah</a>
                    <br>
                </div>
            </div>
            <div class="grid-sub-container">
                <p class="section-span" onclick="this.parentElement.toggleAttribute('collapsed')">Sublime and Revelation:</p>
                <span class="section-collapsed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" height="24" width="36"><path d="m24 30.75-12-12 2.15-2.15L24 26.5l9.85-9.85L36 18.8Z"></path></svg></span>
                <div class="section-body">
                    <a href="./poem?path=/Volume-2/Sublime-And-Revelation/babarian">1. Babarian - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Sublime-And-Revelation/chiss">2. Chiss - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Sublime-And-Revelation/delly">3. Delly - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Sublime-And-Revelation/spiders">4. Spiders - By Zekiah</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Sublime-And-Revelation/a-morbin-time">5. A morbin Time - By Bushi</a>
                    <br>
                </div>
            </div>
            <div class="grid-sub-container">
                <p class="section-span" onclick="this.parentElement.toggleAttribute('collapsed')">Tales and Tomes:</p>
                <span class="section-collapsed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" height="24" width="36"><path d="m24 30.75-12-12 2.15-2.15L24 26.5l9.85-9.85L36 18.8Z"></path></svg></span>
                <div class="section-body">
                    <a href="./poem?path=/Volume-2/Tales-And-Tomes/the-tale-of-major-korean">1. The Tale of Major Korean - By Bushi</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Tales-And-Tomes/the-burial-of-herr-fischer-vi">2. The Burial of Herr Fischer VI - By Bushi</a>
                    <br>
                    <a href="./poem?path=/Volume-2/Tales-And-Tomes/bull-and-bush">3. Bull and Bush - By Angelos</a>
                    <br>
                </div>
            </div>
            <h3>Other stuff:</h3>
            <div class="grid-sub-container">
                <p class="section-span" onclick="this.parentElement.toggleAttribute('collapsed')">Copypastas:</p>
                <span class="section-collapsed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" height="24" width="36"><path d="m24 30.75-12-12 2.15-2.15L24 26.5l9.85-9.85L36 18.8Z"></path></svg></span>
                <div class="section-body">
                    <a href="Other/a-joke">1. A joke - By Zekiah</a>
                    <br>
                    <a href="Other/the-redditor">2. The Redditor - By Bushi</a>
                    <br>
                </div>
            </div>
            <div class="grid-sub-container">
                <p class="section-span" onclick="this.parentElement.toggleAttribute('collapsed')">Sussy songs</p>
                <span class="section-collapsed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" height="24" width="36"><path d="m24 30.75-12-12 2.15-2.15L24 26.5l9.85-9.85L36 18.8Z"></path></svg></span>
                <div class="section-body">
                    <a href="#">1. AQGay (Lyrics) - By Zekiah (as SussZ)</a>
                    <br>
                    <a href="#">2. Filthy French (Lyrics) - By Zekiah (as SussZ)</a>
                    <br>
                </div>
            </div>
        </div>
    </div>
    <br><br>
    what are you doing down here? lol
    <a href="./" class="back"><- Back</a>
</body>
<script></script>
<script>
    const params = new URLSearchParams(document.location.search)

    let stringToHtml = text => {
        let htmlObject = document.createElement('temp')
        htmlObject.innerHTML = text
        return htmlObject.firstElementChild
    }

    function searchContents(value) {
        //search through poem, authors, etc
        document.querySelectorAll(".section-body a").forEach((elem) => {
            elem.style.display = 'inline-block'
            if (!value.toLowerCase().trim()) return
            if (!elem.textContent.toLowerCase().includes(value.toLowerCase().trim())) {
                elem.style.display = 'none'
                return
            }

            elem.parentElement.parentElement.removeAttribute("collapsed")
        })
        document.querySelectorAll(".section-body br").forEach((lnb) => {
            lnb.style.display = 'inline-block'
            if (!value.toLowerCase().trim()) return
            else lnb.style.display = 'none'
        })
    }

    async function addPurgatoryEntries(filter) {
        let entryTemplate = stringToHtml(await (await fetch("./Other/purgatory-entry-template")).text())

        while (purgatoryFlex.firstChild) { purgatoryFlex.removeChild(purgatoryFlex.lastChild) }
        while (purgatoryGrid.firstChild) { purgatoryGrid.removeChild(purgatoryGrid.lastChild) }

        purgatoryGrid.style.display = "none"
        purgatoryFlex.style.display = "flex"

        let entries = null
        let element = purgatoryFlex

        if (filter == "all") {
            purgatoryFlex.style.display = "none"
            purgatoryGrid.style.display = "grid"
            element = purgatoryGrid

            entries = await (await fetch("https://server.poemanthology.org:81/PurgatoryAll")).json()
        }
        else if (filter == "liked") {
            entries = await isLoggedIn() ? (await getAccountData()).likedPoems : JSON.parse(localStorage.liked)

            if (entries == null || entries.length == 0) {
                purgatoryFlex.innerHTML = "<p style=\"text-align: center; width: 100%;\">😢 You haven't liked any poems...<br>Press the star icon on a poem to add one to your liked list!</p>"
            }
        }
        else if (filter == "new") {
            //Picks appear first on new, and have a different template
            let picks = await (await fetch("https://server.poemanthology.org:81/PurgatoryPicks")).json()
            let pickTemplate = entryTemplate.cloneNode(true)
            pickTemplate.querySelector("#_specialNotification").textContent = "Subliminal pick"
            pickTemplate.querySelector("#_specialTooltip").textContent = "The best of the best - this poem has been selected by the subliminal team to be something that you SHOULD see now!"
            
           
            for (let pickEntry of picks) { await appendEntry(pickEntry, purgatoryFlex, pickTemplate) }
            
            entries = await (await fetch("https://server.poemanthology.org:81/PurgatoryNew")).json()
        }

        for (let entry of entries) { await appendEntry(entry, element, entryTemplate) }

        if (!params.get("purgatorynew") || filter != "new" || !purgatoryFlex.children[0]) return

        let newTemplate = entryTemplate.cloneNode(true)
        newTemplate.querySelector("#_specialNotification").textContent = "New submission!"
        newTemplate.querySelector("#_specialTooltip").textContent = "Well done, but only the purgatory can decide the fate of this poem now..."
        let newElement = await appendEntry(params.get("purgatorynew"), purgatoryFlex, newTemplate)
        
        window.scrollTo(0, 0)
        purgatoryFlex.scrollTo(1e4, 0) //TEMP 
        newElement.classList.add("entry-new")
        setTimeout(() => newElement.classList.remove("entry-new"), 800)
        params.delete("purgatorynew")
    }

    async function appendEntry(entry, element, template) {
        let entryData = await (await fetch("https://server.poemanthology.org:81/Purgatory/" + entry)).json()
        let newE = template.cloneNode(true)
        newE.setAttribute("guid", entryData?.guid)
        newE.querySelector("#_poemPreview").textContent = (
            entryData.poemContent?.substring(0, 56)
            .replace(/<[^>]*>?/gm, " ")
            .replace(/\s+/g, " ")
            .trim()
        )
        newE.querySelector("#_poemName").textContent = entryData.poemName?.substring(0, 32).replace(/<[^>]*>?/gm, " ")
        newE.querySelector("#_poemAuthor").textContent = "By " + entryData.poemAuthor?.substring(0, 6).replace(/<[^>]*>?/gm, "") + "..."
        newE.querySelector("#_approves").textContent = entryData.approves || 0
        newE.querySelector("#_vetoes").textContent = entryData.vetoes || 0

        element.appendChild(newE)
        return newE
    }

    function confirmFail(e) {
        alert("Failed to load account data " + e)
        localStorage.removeItem("accountCode")
        localStorage.removeItem("accountGuid")
    }

    async function signup(penName) {
        fetch("https://server.poemanthology.org:81/Signup", {
            method: "POST",
            headers: { 'Content-Type': 'application/json' },
            body: '"' + penName + '"'
        })
        .then((response) => {
            if (!response.ok) { confirmFail("signup response was denied."); return }
            return response.json()
        })
        .then((dataObject) => {
            localStorage.accountCode = dataObject.code
            localStorage.accountGuid = dataObject.guid

            loginCodeText.textContent = dataObject.code

            let qr = new QRious({
                element: loginCodeQR,
                background: "white",
                foreground: "#007bd3",
                level: "L",
                size: 512,
                value: window.location + "?accountCode=" + dataObject.code
            })
            loginCodeQR.src = qr.toDataURL()

            showMyAccount()
        })
        .catch((e) => confirmFail(e))
    }

    //Impossible to log in without code, GUID can be retrieved though
    async function signin(code) {
        fetch('https://server.poemanthology.org:81/Signin', {
            method: "POST",
            headers: { 'Content-Type': 'application/json' },
            body: '"' + code + '"'
        })
            .then((signinResponse) => {
                if (!signinResponse.ok) { confirmFail("signin response was denied."); return }
                return signinResponse.json()
            })
            .then((signinData) => {
                localStorage.accountCode = code
                localStorage.accountGuid = signinData.guid
                showMyAccount()
            })
            .catch((e) => confirmFail(e))
    }

    function showMyAccount() {
        loginButton.style.display = 'none'
        accountButton.style.display = 'block'
    }

    async function initialise() {
        // If on mobile, collapse sections by default to make site more compact
        if (window.matchMedia("(orientation: portrait)").matches) {
            document.querySelectorAll(".grid-sub-container")
                .forEach(elem => elem.setAttribute("collapsed", true))
        }

        if (params.get("accountCode")) {
            signin(params.get("accountCode"))
        }
        else if (await isLoggedIn()) {
            showMyAccount()
        }
    }


    //Site scripts
    initialiseHeader()
    initialise()
    addPurgatoryEntries("new")

    filtersBar.addEventListener("mousemove", event => {
        for (let button of filtersBar.children) {
            button.style.background = 'radial-gradient(at left ' + (event.screenX - button.offsetLeft) + 'px top ' + (event.screenY - button.offsetTop) + 'px, darkgray, white)'
        }
    })

    console.log("%cYour account's data is held in browser local storage, a thing that can be acessed by putting code in this browser console! If someone tells you to put something here, there is a high chance that you may get hacked!", "background: red; color: yellow; font-size: large")
    console.log("%cTL;DR: Never put anything you do not understand here. Uncool things may happen.", "color: blue; font-size: x-large")
</script>

</html>
