<!DOCTYPE html>
<html>
<head>
  <title>Subliminal</title>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="../../styles.css">
  <meta name="description" content="">
  <meta name="keywords" content="">
</head>
 
<body style="background: initial;">
    <div class="title-blur">
        <h2 class="centre content" id="poemTitle"></h2>
        <hr>
    </div>
    <div id="poemMain" class="poem-centre">
        <p id="poemContent"></p>
    </div>
    <a href="./contents" class="back"> <- Back</a>
    <a href="javascript: window.location.href = '../../poem-editor?edit=' + window.location.pathname + ',version=2'" class="edit"><svg xmlns="http://www.w3.org/2000/svg" height="32" width="32" viewBox="0 0 48 48"><path d="M9 39h2.2l22.15-22.15-2.2-2.2L9 36.8Zm30.7-24.3-6.4-6.4 2.1-2.1q.85-.85 2.1-.85t2.1.85l2.2 2.2q.85.85.85 2.1t-.85 2.1Zm-2.1 2.1L12.4 42H6v-6.4l25.2-25.2Zm-5.35-1.05-1.1-1.1 2.2 2.2Z"></path></svg></a>
</body>
<script>
    async function initialise() {
        const params = new URLSearchParams(document.location.search)
        const path = params.get("path")
        const poemData = await (await fetch(window.location.protocol + "\/\/" + window.location.hostname + path + ".json")).json()
        
        //Set up title and url bar for vanity
        window.history.replaceState(null, "Title", "/" + path)
        document.title = "Subliminal - " + poemData.title

        //Place poem data into the DOM
        poemContent.innerText = poemData.content
        poemMain.class = poemData.pageStyle
        document.body.style.background = poemData.background
    }
    
    initialise()
</script>
</html>
